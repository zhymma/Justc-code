get train data loader...
total input dataset len: 1730
  0%|          | 0/1730 [00:00<?, ?it/s]100%|██████████| 1730/1730 [00:00<00:00, 33401.67it/s]
get dev data loader...
after process dataset len: 1730
total passed: 0
total input dataset len: 433
  0%|          | 0/433 [00:00<?, ?it/s]100%|██████████| 433/433 [00:00<00:00, 31157.40it/s]
define model...
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
define optimizer...
/data/zhyma/miniconda3/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
>>>>>>>>>>>>>>>>>>>start train......
epoch:0,	loss_g:0,	loss_d:0,	loss_c:89.31255557388067
>>>>>>>>>>>>>>>>>>>start evaluate......
code_right: 1799.0	code_total: 1963	M-tree codes acc: 0.9164544065206317
disc_right:1822,	disc_all:1963,	discriminator acc:0.9281711665817626
precision:0.9367755532139094,	recall:0.9883268482490273,	F1:0.9618609683527184
TP:1778.0,TN:44.0,FN:21.0,FP:120.0
corrector_right: 2.0	corrector_total: 164.0	corrector acc: 0.012195121951219513
final_code_right: 1779.0	final_code_total: 1963	final_code acc: 0.9062659195109526
save best model to ./output/corrector2/best_model
